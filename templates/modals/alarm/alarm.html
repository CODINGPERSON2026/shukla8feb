<style>
    .alarm-gradient {
        position: relative;
        overflow: hidden;
        background: linear-gradient(135deg, #da4444, #c209a3);
        color: #fff;
        padding: 2px 18px;
        border-radius: 30px;
        font-weight: 600;
        font-size: 0.75rem;
        display: inline-flex;
        align-items: center;
        gap: 18px;
    }

    /* Shine Effect */
    .alarm-gradient::after {
        content: "";
        position: absolute;
        top: 0;
        left: -60%;
        width: 60%;
        height: 100%;
        background: linear-gradient(120deg,
                rgba(255, 255, 255, 0) 0%,
                rgba(255, 255, 255, 0.45) 50%,
                rgba(255, 255, 255, 0) 100%);
        transform: skewX(-25deg);
        animation: shine 2.5s infinite;
    }

    @keyframes shine {
        0% {
            left: -60%;
        }

        100% {
            left: 120%;
        }
    }
</style>

<!-- Toast Container -->
<span id="alarmAlert" class="alarm-gradient d-none" style="cursor:pointer;">
    ðŸ”” You have Detachment alarms!
</span>

<script>
    async function showAssignedAlarms() {
        try {
            const res = await fetch('/api/assigned_alarm');
            if (!res.ok) throw new Error("Network error");

            const result = await res.json();
            const alarmAlert = document.getElementById("alarmAlert");

            if (result.rows && result.rows.length > 0) {
                alarmAlert.classList.remove("d-none");
                alarmAlert.classList.add("alert-pulse");
                alarmAlert.innerText = `ðŸ”” You have ${result.rows.length} Detachment alarm(s)!`;
            } else {
                alarmAlert.classList.add("d-none");
                alarmAlert.classList.remove("alert-pulse");
            }

        } catch (err) {
            console.error("Error fetching assigned alarms:", err);
        }
    }

    document.addEventListener('DOMContentLoaded', showAssignedAlarms);

    document.getElementById("alarmAlert").addEventListener("click", function () {
        const detModal = new bootstrap.Modal(document.getElementById('detModal'));
        detModal.show();
        load_det_personnel("", 90);
        load_detachments();
    });
</script>